<!-- Field types specific to Franklin only -->

<fieldtype name="xml" class="solr.TextField" sortMissingLast="true">
    <analyzer type="query">
        <charFilter class="solr.ICUNormalizer2CharFilterFactory" name="nfkc"/> <!-- no case folding initially -->
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Traditional-Simplified"/>
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Katakana-Hiragana" assumeExternalUnicodeNormalization="true"/>
        <tokenizer class="solr.ICUTokenizerFactory" rulefiles="Latn:Latin-dont-break-on-hyphens.rbbi,Zyyy:Latin-dont-break-on-hyphens.rbbi"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="protwords.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="1" preserveOriginal="1" stemEnglishPossessive="0" protected="protwords.txt"/>
        <filter class="solr.ICUFoldingFilterFactory"/>
    </analyzer>
    <analyzer type="index">
        <charFilter class="solr.HTMLStripCharFilterFactory"/>
        <charFilter class="solr.ICUNormalizer2CharFilterFactory" name="nfkc"/> <!-- no case folding initially -->
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Traditional-Simplified"/>
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Katakana-Hiragana" assumeExternalUnicodeNormalization="true"/>
        <tokenizer class="solr.ICUTokenizerFactory" rulefiles="Latn:Latin-dont-break-on-hyphens.rbbi,Zyyy:Latin-dont-break-on-hyphens.rbbi"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="1" preserveOriginal="1" stemEnglishPossessive="0" protected="protwords.txt"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        <filter class="solr.ICUFoldingFilterFactory"/>
        <filter class="solr.FlattenGraphFilterFactory"/>
        <filter class="solr.PositionLengthOrderTokenFilterFactory" indexLookahead="true"/>
    </analyzer>
</fieldtype>


<fieldtype name="isxn" class="solr.TextField">
	<analyzer>
		<tokenizer class="solr.KeywordTokenizerFactory"/>
		<filter class="solr.PatternReplaceFilterFactory" pattern="\(.*\)" replacement="" replace="all"/>
		<filter class="solr.LowerCaseFilterFactory"/>
		<filter class="solr.PatternReplaceFilterFactory" pattern="[^0-9x]" replacement="" replace="all"/>
		<filter class="solr.LengthFilterFactory" min="8" max="15"/>
	</analyzer>
</fieldtype>


<!-- this was "tint" -->
<fieldType name="date_int" class="solr.TrieIntField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>


<!-- this sorta duplicates tsearch fields in Bill's schema -->
<fieldType name="search" class="solr.TextField" positionIncrementGap="100">
    <analyzer type="query">
        <charFilter class="solr.ICUNormalizer2CharFilterFactory" name="nfkc"/> <!-- no case folding initially -->
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Traditional-Simplified"/>
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Katakana-Hiragana" assumeExternalUnicodeNormalization="true"/>
        <tokenizer class="solr.ICUTokenizerFactory" rulefiles="Latn:Latin-dont-break-on-hyphens.rbbi,Zyyy:Latin-dont-break-on-hyphens.rbbi"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="protwords.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="1" preserveOriginal="1" stemEnglishPossessive="1" protected="protwords.txt"/>
        <filter class="solr.ICUFoldingFilterFactory"/>
    </analyzer>
    <analyzer type="index">
        <charFilter class="solr.ICUNormalizer2CharFilterFactory" name="nfkc"/> <!-- no case folding initially -->
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Traditional-Simplified"/>
        <charFilter class="solr.ICUTransformCharFilterFactory" id="Katakana-Hiragana" assumeExternalUnicodeNormalization="true"/>
        <tokenizer class="solr.ICUTokenizerFactory" rulefiles="Latn:Latin-dont-break-on-hyphens.rbbi,Zyyy:Latin-dont-break-on-hyphens.rbbi"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="1" preserveOriginal="1" stemEnglishPossessive="0" protected="protwords.txt"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        <filter class="solr.ICUFoldingFilterFactory"/>
        <filter class="solr.FlattenGraphFilterFactory"/>
        <filter class="solr.ReversedWildcardFilterFactory" withOriginal="true" maxPosAsterisk="3" maxPosQuestion="2" maxFractionAsterisk="0.33"/>
        <filter class="solr.PositionLengthOrderTokenFilterFactory" indexLookahead="true"/>
    </analyzer>
</fieldType>

<fieldType name="ssort" class="solr.TextField" positionIncrementGap="0" omitNorms="true" sortMissingLast="true">
    <analyzer>
        <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.ICUFoldingFilterFactory"/>
        <filter class="solr.PatternReplaceFilterFactory" pattern=" &amp; " replacement=" and "/>
        <filter class="solr.PatternReplaceFilterFactory" pattern="(\p{IsAlphabetic})['â€™](\p{IsAlphabetic})" replacement="$1$2"/>
        <filter class="solr.PatternReplaceFilterFactory" pattern="[^\p{IsAlphabetic}\p{Digit}]+" replacement=" "/>
        <filter class="solr.TrimFilterFactory"/>
        <filter class="solr.WordDelimiterGraphFilterFactory" generateWordParts="0" generateNumberParts="0" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="0" splitOnNumerics="0" preserveOriginal="0" stemEnglishPossessive="0" types="wdftypes-headingSort.txt"/>
        <filter class="solr.FlattenGraphFilterFactory"/>
    </analyzer>
</fieldType>
