
<!-- Field types for solrplugins -->

<fieldType name="xfacet2_input" class="edu.upenn.library.solrplugins.CaseInsensitiveSortingTextField" omitNorms="true" serializer="edu.upenn.library.solrplugins.URIEscapeSerializer" displayizer="edu.upenn.library.solrplugins.NonFilingPrefixCombiner" payloadHandler="edu.upenn.library.solrplugins.JsonReferencePayloadHandler">
    <analyzer type="index">
        <charFilter class="solr.ICUNormalizer2CharFilterFactory" name="nfc"/>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="edu.upenn.library.xref.solr.ClientTokenFilterFactory" serviceURI="${solr.xref.client:ws://localhost:12345/websocket}"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeSplitFilterFactory" includeTypes="filing" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.ICUFoldingFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern=" &amp; " _replacement=" and "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="(\p{IsAlphabetic})['’](\p{IsAlphabetic})" _replacement="$1$2"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="[^\p{IsAlphabetic}\p{Digit}]+" _replacement=" "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.TrimFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.WordDelimiterGraphFilterFactory" _generateWordParts="0" _generateNumberParts="0" _catenateWords="1" _catenateNumbers="1" _catenateAll="1" _splitOnCaseChange="0" _splitOnNumerics="0" _preserveOriginal="0" _stemEnglishPossessive="0" _types="wdftypes-headingSort.txt"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeJoinFilterFactory" inputTypes="normalized,filing,prefix" outputType="indexed" typeForPayload="normalized" outputComponents="false" displayComponentTypes="prefix,filing"/>
    </analyzer>
    <analyzer type="query">
        <tokenizer class="edu.upenn.library.solrplugins.JsonReferencePayloadTokenizerFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeSplitFilterFactory" includeTypes="filing" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.ICUFoldingFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern=" &amp; " _replacement=" and "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="(\p{IsAlphabetic})['’](\p{IsAlphabetic})" _replacement="$1$2"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="[^\p{IsAlphabetic}\p{Digit}]+" _replacement=" "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.TrimFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.WordDelimiterGraphFilterFactory" _generateWordParts="0" _generateNumberParts="0" _catenateWords="1" _catenateNumbers="1" _catenateAll="1" _splitOnCaseChange="0" _splitOnNumerics="0" _preserveOriginal="0" _stemEnglishPossessive="0" _types="wdftypes-headingSort.txt"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeJoinFilterFactory" inputTypes="normalized,filing,prefix" outputType="indexed" typeForPayload="normalized" outputComponents="true"/>
    </analyzer>
</fieldType>


<fieldType name="xfacet2" class="edu.upenn.library.solrplugins.CaseInsensitiveSortingTextField" omitNorms="true" serializer="edu.upenn.library.solrplugins.URIEscapeSerializer" displayizer="edu.upenn.library.solrplugins.NonFilingPrefixCombiner" payloadHandler="edu.upenn.library.solrplugins.JsonReferencePayloadHandler">
    <analyzer type="index" class="solr.PreAnalyzedField$PreAnalyzedAnalyzer"/>
    <analyzer type="query">
        <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
        <tokenizer class="edu.upenn.library.solrplugins.JsonReferencePayloadTokenizerFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeSplitFilterFactory" includeTypes="filing" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.ICUFoldingFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern=" &amp; " _replacement=" and "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="(\p{IsAlphabetic})['’](\p{IsAlphabetic})" _replacement="$1$2"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.PatternReplaceFilterFactory" _pattern="[^\p{IsAlphabetic}\p{Digit}]+" _replacement=" "/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.TrimFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.WordDelimiterGraphFilterFactory" _generateWordParts="0" _generateNumberParts="0" _catenateWords="1" _catenateNumbers="1" _catenateAll="1" _splitOnCaseChange="0" _splitOnNumerics="0" _preserveOriginal="0" _stemEnglishPossessive="0" _types="wdftypes-headingSort.txt"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeJoinFilterFactory" inputTypes="normalized,filing,prefix" outputType="indexed" typeForPayload="normalized" outputComponents="true"/>
    </analyzer>
</fieldType>

<fieldType name="shingles" class="solr.TextField" indexed="true" stored="false" omitNorms="true" omitPositions="true">
  <analyzer class="solr.PreAnalyzedField$PreAnalyzedAnalyzer"/>
</fieldType>

<fieldType name="call_number_xfacet" class="edu.upenn.library.solrplugins.CaseInsensitiveSortingTextField" omitNorms="true"
           serializer="edu.upenn.library.solrplugins.URIEscapeSerializer">
    <analyzer type="index">
        <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
        <tokenizer class="edu.upenn.library.solrplugins.JsonReferencePayloadTokenizerFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeSplitFilterFactory" inputTypeRename="filing" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.ICUFoldingFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="edu.upenn.library.solrplugins.callno.CallNoFilterFactory" _normalizers="V:DVDNormalizer, C:CDNormalizer, X:MsCodexNormalizer, L:LCNormalizer, D:DeweyNormalizer, S:DissertationNormalizer, M:MicroNormalizer" _defaultType="O"/>
        <filter class="edu.upenn.library.solrplugins.callno.TypePrefixFilterFactory" delimiter="-" includeTypes="O,L,V,C,D,S,M,X" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeJoinFilterFactory" inputTypes="normalized,filing" outputType="indexed" outputComponents="false"/>
    </analyzer>
    <analyzer type="query">
        <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
        <tokenizer class="edu.upenn.library.solrplugins.JsonReferencePayloadTokenizerFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeSplitFilterFactory" includeTypes="filing" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="solr.ICUFoldingFilterFactory"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeProcessFilterFactory" includeTypes="normalized" _class="edu.upenn.library.solrplugins.callno.CallNoFilterFactory" _normalizers="V:DVDNormalizer, C:CDNormalizer, X:MsCodexNormalizer, L:LCNormalizer, D:DeweyNormalizer, S:DissertationNormalizer, M:MicroNormalizer" _defaultType="O"/>
        <filter class="edu.upenn.library.solrplugins.callno.TypePrefixFilterFactory" delimiter="-" includeTypes="O,L,V,C,D,S,M,X" outputType="normalized"/>
        <filter class="edu.upenn.library.solrplugins.tokentype.TokenTypeJoinFilterFactory" inputTypes="normalized,filing" outputType="indexed" outputComponents="true"/>
    </analyzer>
</fieldType>
